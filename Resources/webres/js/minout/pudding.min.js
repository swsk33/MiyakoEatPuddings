let puddingArray=[],moveUp;const puddingRol=8,puddingCol=4,puddingSize={puddingWidth:60,puddingHeight:60},puddingMatrixSize={matrixWidth:4*(puddingSize.puddingWidth+10)-10,matrixHeight:8*(puddingSize.puddingHeight+5)-5};function Pudding(dom,isEaten,score){this.dom=dom,this.isEaten=isEaten,this.score=score}for(let i=0;i<4;i++)for(let j=0;j<8;j++){let eachPuddingDom=document.querySelector(".game .gameBg .pudding-"+i+"-"+j),eachPuddingScore;eachPuddingDom.style.display="block",eachPuddingDom.style.left=gameBackground.offsetWidth-puddingMatrixSize.matrixWidth+i*(puddingSize.puddingWidth+10)+"px",eachPuddingDom.style.top=j*(puddingSize.puddingHeight+5)+"px",eachPuddingScore=i<2?1:2==i?2:3;let eachPudding=new Pudding(eachPuddingDom,!1,eachPuddingScore);puddingArray.push(eachPudding)}function initializePuddings(){for(let i=0;i<4;i++)for(let j=0;j<8;j++)puddingArray[8*i+j].dom.style.display="block",puddingArray[8*i+j].dom.style.left=gameBackground.offsetWidth-puddingMatrixSize.matrixWidth+i*(puddingSize.puddingWidth+10)+"px",puddingArray[8*i+j].dom.style.top=j*(puddingSize.puddingHeight+5)+"px",puddingArray[8*i+j].isEaten=!1;moveUp=!1}function getPuddingAtBorder(){let puddingAtBorder={borderTop:puddingArray[0].dom,borderBottom:puddingArray[7].dom},rolIsExists;rolIsExists=!1;for(let i=0;i<8;i++){for(let j=0;j<4;j++){let isVisible="none"!=window.getComputedStyle(puddingArray[8*j+i].dom,null).getPropertyValue("display");if(!puddingArray[8*j+i].isEaten||isVisible){rolIsExists=!0,puddingAtBorder.borderTop=puddingArray[8*j+i].dom;break}}if(rolIsExists)break}rolIsExists=!1;for(let i=7;i>=0;i--){for(let j=0;j<4;j++){let isVisible="none"!=window.getComputedStyle(puddingArray[8*j+i].dom,null).getPropertyValue("display");if(!puddingArray[8*j+i].isEaten||isVisible){rolIsExists=!0,puddingAtBorder.borderBottom=puddingArray[8*j+i].dom;break}}if(rolIsExists)break}return puddingAtBorder}function isPuddingOutOfBound(){let isOut=!1;for(let i=0;i<puddingArray.length;i++)if(!puddingArray[i].isEaten){let criteria1=miyako.offsetTop+miyako.offsetHeight>=puddingArray[i].dom.offsetTop&&miyako.offsetLeft+miyako.offsetWidth>=puddingArray[i].dom.offsetLeft,criteria2=miyako.offsetTop<=puddingArray[i].dom.offsetTop+puddingArray[i].dom.offsetHeight&&miyako.offsetLeft<=puddingArray[i].dom.offsetLeft+puddingArray[i].dom.offsetWidth,criteria3=puddingArray[i].dom.offsetLeft<=0;if(isOut=criteria1&&criteria2||criteria3,isOut)break}return isOut}function isEatUp(){let isDone=!0;for(let i=0;i<puddingArray.length;i++)if(!puddingArray[i].isEaten){isDone=!1;break}return isDone}function puddingMove(){let velocity=1+2*level;isPuddingOutOfBound()&&healthDown(),isEatUp()&&(addScore(10*level),level++,operateSuccessPage(!0),stopGameProcess(),saveData());let topDistance=getPuddingAtBorder().borderTop.offsetTop,bottomDistance=gameBackground.offsetHeight-getPuddingAtBorder().borderBottom.offsetTop-puddingSize.puddingHeight;if(moveUp)if(topDistance-velocity<=0){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop-topDistance+"px");moveUp=!1,setTimeout((function(){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.left=puddingArray[i].dom.offsetLeft-50+"px")}),5)}else for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop-velocity+"px");else if(bottomDistance<=velocity){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop+bottomDistance+"px");moveUp=!0,setTimeout((function(){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.left=puddingArray[i].dom.offsetLeft-50+"px")}),5)}else for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop+velocity+"px")}getPuddingAtBorder();
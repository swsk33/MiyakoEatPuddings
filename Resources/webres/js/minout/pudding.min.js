let puddingArray=[],moveUp;const puddingRol=8,puddingCol=4,puddingSize={puddingWidth:60,puddingHeight:60},puddingMatrixSize={matrixWidth:4*(puddingSize.puddingWidth+10)-10,matrixHeight:8*(puddingSize.puddingHeight+5)-5};function initializePuddings(){let puddingDom=[],eachPuddingDom;for(let i=0;i<4;i++)for(let j=0;j<8;j++)eachPuddingDom=document.querySelector(".game .gameBg .pudding-"+i+"-"+j),puddingDom.push(eachPuddingDom),eachPuddingDom.style.left=gameBackground.offsetWidth-puddingMatrixSize.matrixWidth+i*(puddingSize.puddingWidth+10)+"px",eachPuddingDom.style.top=j*(puddingSize.puddingHeight+5)+"px",eachPuddingDom.style.transform="scale(1) rotate(0deg)";puddingArray=[];for(let i=0;i<puddingDom.length;i++){let scoreEachPudding;i>=0&&i<=15?scoreEachPudding=1:i>=16&&i<=23?scoreEachPudding=2:i>=24&&i<=31&&(scoreEachPudding=3);let eachPudding={dom:puddingDom[i],isEaten:!1,score:scoreEachPudding};eachPudding.dom.style.display="block",puddingArray.push(eachPudding)}moveUp=!1}function getPuddingAtBorder(){let puddingAtBorder={borderTop:null,borderBottom:null},rolIsExists;rolIsExists=!1;for(let i=0;i<8;i++){for(let j=0;j<4;j++)if(!puddingArray[8*j+i].isEaten){rolIsExists=!0,puddingAtBorder.borderTop=puddingArray[8*j+i].dom;break}if(rolIsExists)break}rolIsExists=!1;for(let i=7;i>=0;i--){for(let j=0;j<4;j++)if(!puddingArray[8*j+i].isEaten){rolIsExists=!0,puddingAtBorder.borderBottom=puddingArray[8*j+i].dom;break}if(rolIsExists)break}return puddingAtBorder}function isPuddingOutOfBound(){let isOut=!1;for(let i=0;i<puddingArray.length;i++)if(!puddingArray[i].isEaten){let criteria1=miyako.offsetTop+miyako.offsetHeight>=puddingArray[i].dom.offsetTop&&miyako.offsetLeft+miyako.offsetWidth>=puddingArray[i].dom.offsetLeft,criteria2=miyako.offsetTop<=puddingArray[i].dom.offsetTop+puddingArray[i].dom.offsetHeight&&miyako.offsetLeft<=puddingArray[i].dom.offsetLeft+puddingArray[i].dom.offsetWidth,criteria3=puddingArray[i].dom.offsetLeft<=0;if(isOut=criteria1&&criteria2||criteria3,isOut)break}return isOut}function isEatUp(){let isDone=!0;for(let i=0;i<puddingArray.length;i++)if(!puddingArray[i].isEaten){isDone=!1;break}return isDone}function puddingMove(){let velocity=1+2*level;isPuddingOutOfBound()&&healthDown(),isEatUp()&&(level++,addScore(10*level),operateSuccessPage(!0),stopGameProcess(),saveData(),refreshDom());let topDistance=getPuddingAtBorder().borderTop.offsetTop,bottomDistance=gameBackground.offsetHeight-getPuddingAtBorder().borderBottom.offsetTop-puddingSize.puddingHeight;if(moveUp)if(topDistance-velocity<=0){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop-topDistance+"px");moveUp=!1,setTimeout((function(){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.left=puddingArray[i].dom.offsetLeft-50+"px")}),5)}else for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop-velocity+"px");else if(bottomDistance<=velocity){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop+bottomDistance+"px");moveUp=!0,setTimeout((function(){for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.left=puddingArray[i].dom.offsetLeft-50+"px")}),5)}else for(let i=0;i<puddingArray.length;i++)puddingArray[i].isEaten||(puddingArray[i].dom.style.top=puddingArray[i].dom.offsetTop+velocity+"px")}
let level,health,highScore,currentScore=0,weaponCount=[];function addScore(score){currentScore=parseInt(currentScore)+score,currentScore>highScore&&(highScore=currentScore),refreshDom()}function saveData(){let data={level:level,health:health,highScore:highScore,currentScore:currentScore,weaponCount:weaponCount},dataStr=JSON.stringify(data);window.localStorage.setItem("data",dataStr)}function readData(){let isNewGame=!1,data=JSON.parse(window.localStorage.getItem("data"));if(null==data||0==data.highScore){currentScore=0,highScore=0,health=3,level=1,weaponCount=[];for(let i=0;i<weaponList.length;i++)0==i?weaponCount.push(-1):weaponCount.push(0);isNewGame=!0}else level=data.level,health=data.health,highScore=data.highScore,currentScore=data.currentScore,weaponCount=data.weaponCount;return refreshDom(),isNewGame}function resetData(){currentScore=0,health=3,level=1,weaponCount=[];for(let i=0;i<weaponList.length;i++)0==i?weaponCount.push(-1):weaponCount.push(0);refreshDom()}function refreshDom(){currentScoreDom.innerHTML="积分："+currentScore,highScoreDom.innerHTML="最高分数："+highScore,healthDom.innerHTML="x"+health,levelDom.innerHTML="第"+level+"关",weaponDom.children[0].innerHTML=weaponList[currentWeaponIndex].name,weaponDom.children[1].src=weaponList[currentWeaponIndex].texture,0==currentWeaponIndex?weaponDom.children[2].innerHTML="x无限":weaponDom.children[2].innerHTML="x"+weaponCount[currentWeaponIndex]}function genRandom(min,max){return Math.floor(Math.random()*(max-min+1)+min)}